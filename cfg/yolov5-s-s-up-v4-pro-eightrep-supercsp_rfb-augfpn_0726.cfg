[net]
batch=64
subdivisions=8
width=1024
height=1024
channels=3
momentum=0.949
decay=0.0005
angle=0
saturation = 1.5
exposure = 1.5
hue=.1

learning_rate=0.001
burn_in=1000
max_batches = 500500
policy=steps
steps=400000,450000
scales=.1,.1

mosaic=1
letter_box=1
ema_alpha=0.9998

########################## backbone ###########################
# conv params = filters, kernel_size, stride, pad, batch_normalize, activation
[focus]
params = 64, 3, 1, 1, 1, mish

# Downsample
[conv]
params = 128, 3, 2, 1, 1, mish

# / ����˳�� |�����з�֧ * ����ѭ������
# c3
[csp]
convs = 64, 1, 1, 1, 1, mish / 128, 1, 1, 1, 1, mish
block = eightrep : 64, 1, 1, 1, 1, linear / 64, 1, 1, 1, 1, linear | 64, 3, 1, 1, 1, linear
seq = 0 | 0 / block * 3 / cat / 1
super_add = 1

# branch -1 : id : conv
[out]
params = -1 : 128, 1, 1, 1, 1, mish


# Downsample
[conv]
params = 256, 3, 2, 1, 1, mish

# c3
[csp]
convs = 128, 1, 1, 1, 1, linear / 128, 1, 1, 1, 1, mish / 256, 1, 1, 1, 1, mish
block = eightrep : 128, 1, 1, 1, 1, linear / 128, 1, 1, 1, 1, linear | 128, 3, 1, 1, 1, linear
seq = 0 | 1 / block * 9 / cat / 2
super9 = 1
super_add = 1

# branch 1 : id : conv
[out]
params = 0 : 256, 1, 1, 1, 1, mish

# Downsample
[conv]
params = 512, 3, 2, 1, 1, mish


# c3
[csp]
convs = 256, 1, 1, 1, 1, linear / 256, 1, 1, 1, 1, mish / 512, 1, 1, 1, 1, mish
block = eightrep : 256, 1, 1, 1, 1, linear / 256, 1, 1, 1, 1, linear | 256, 3, 1, 1, 1, linear
seq = 0 | 1 / block * 9 / cat / 2
super9 = 1
super_add = 1

# branch 1 : id : conv
[out]
params = 1 : 512, 1, 1, 1, 1, mish

# Downsample
[conv]
params = 1024, 3, 2, 1, 1, mish


[conv]
params = 512, 1, 1, 1, 1, mish

#[spp]
#params = 1, 5 | 1, 9 | 1, 13

[rfb]
params = 1024
flag = 1

[conv]
params = 1024, 1, 1, 1, 1, mish

# c3
[csp]
convs = 1024, 1, 1, 1, 1, mish
block = eightrep : 1024, 1, 1, 1, 1, linear / 1024, 1, 1, 1, 1, linear | 1024, 3, 1, 1, 1, linear
seq = 0 | 0 / block * 3 / cat / 0
super_add = 0

########################## backbone end ###########################
[AugFPN]
#定义输出通道数
params = 512
ratio=0.1, 0.2, 0.3
#判断是否进行增强FPN，不增强则只进行1x1卷积降维处理
is_Aug=1

#[conv]     这个降维卷积内嵌到AugFPN中去了
#params = 512, 1, 1, 1, 1, mish

[upsample]
stride=2

[cat]
froms = 1

[csp]
convs = 512, 1, 1, 1, 1, mish
block = eightrep : 512, 1, 1, 1, 1, linear / 512, 1, 1, 1, 1, linear | 512, 3, 1, 1, 1, linear
seq = 0 | 0 / block * 3 / cat / 0
super_add = 0

[conv]
params = 256, 1, 1, 1, 1, mish

[upsample]
stride=2

[cat]
froms = 0

[csp]
convs = 256, 1, 1, 1, 1, mish
block = eightrep : 256, 1, 1, 1, 1, linear / 256, 1, 1, 1, 1, linear | 256, 3, 1, 1, 1, linear
seq = 0 | 0 / block * 3 / cat / 0
super_add = 0


[conv]
params = 128, 1, 1, 1, 1, mish

[upsample]
stride=2

[cat]
froms = -1


#[csp]
#convs = 128, 1, 1, 1, 1, mish
#block = eightrep : 128, 1, 1, 1, 1, linear / 128, 1, 1, 1, 1, linear | 128, 3, 1, 1, 1, linear
#seq = 0 | 0 / block * 3 / cat / 0
[conv]
params = 256, 1, 1, 1, 1, mish

[multisam]
params = 16, 3, 0, 1, 7

########################## yolo 64
[detect]
params = 21, 1, 1, 1, 0, logistic

[yolo]
mask = 0,1,2
anchors = 5,5,9,9,16,15
classes=2
num=3
jitter=.1
scale_x_y = 2.0
objectness_smooth=0
ignore_thresh = .7
truth_thresh = 1
#random=1
resize=1.5
iou_thresh=0.2
iou_normalizer=0.05
cls_normalizer=0.5
obj_normalizer=4.0
iou_loss=ciou
nms_kind=diounms
beta_nms=0.6
new_coords=1
max_delta=5

